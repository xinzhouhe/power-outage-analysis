{"version":3,"file":"424.primer_spec_plugin.min.js","mappings":"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","sources":["webpack:///./conditional_plugins/halloween.plugin.tsx","webpack:///./conditional_plugins/conditional_plugins.ts"],"sourcesContent":["/** @jsx JSXDom.h */\nimport * as JSXDom from 'jsx-dom';\nexport function initialize() {\n    return {\n        id: 'halloween',\n        plugin: HalloweenPlugin,\n        shouldRun: () => {\n            const today = new Date();\n            // Console message if we are *just* past the Halloween-mode end-date.\n            if (today.getMonth() === 10 &&\n                today.getDate() > 5 &&\n                today.getDate() <= 15) {\n                const enabled_url = new URL(window.location.href);\n                enabled_url.searchParams.set('enable_halloween', '1');\n                console.info(\"ðŸ¤« Psst... It's well past halloween, but you can re-enable halloween mode by clicking this url:\\n\", enabled_url.toString());\n            }\n            // Remember that months are 0-indexed in JS!\n            return ((today.getMonth() === 9 && today.getDate() >= 25) ||\n                (today.getMonth() === 10 && today.getDate() <= 5));\n        },\n    };\n}\nasync function HalloweenPlugin(input) {\n    registerHalloweenSubthemeIfNeeded();\n    if (!input.settings_shown) {\n        replaceSettingsToggleWithHat();\n    }\n    else {\n        insertPumpkinsInThemePreview();\n    }\n    replaceSidebarToggleWithBook();\n    toggleFontIfNeeded(input.subtheme_name);\n    registerDblclickEasterEggIfNeeded(input.subtheme_name);\n    insertShyEmojiIfNeeded(input.subtheme_name);\n}\nfunction replaceSettingsToggleWithHat() {\n    const settingsIconClassList = document.querySelector('.primer-spec-settings-toggle i.fa-cog')?.classList;\n    if (settingsIconClassList) {\n        settingsIconClassList.remove('fa-cog');\n        settingsIconClassList.add('fa-hat-wizard');\n    }\n}\nfunction replaceSidebarToggleWithBook() {\n    const sidebarToggles = document.querySelectorAll('.primer-spec-hoverable i.fa-bars');\n    sidebarToggles.forEach((sidebarToggle) => {\n        sidebarToggle.classList.remove('fa-cog');\n        sidebarToggle.classList.add('fa-book-dead');\n    });\n}\n// Acknowledgement: The _design_ inspiration for this easter egg comes from a\n// similar easter egg in WhatsApp Web, where clicking on an expired \"view-once\"\n// media message shows an animated \"ðŸ¤«\" emoji.\nfunction createGhostEasterEggOnClick(event) {\n    let startX, startY;\n    if (event instanceof TouchEvent) {\n        startX = event.touches[0].clientX;\n        startY = event.touches[0].clientY;\n    }\n    else {\n        startX = event.clientX;\n        startY = event.clientY;\n    }\n    const ghostSize = 32;\n    startX -= ghostSize / 2;\n    startY -= ghostSize / 2;\n    const easterEggEmoji = (JSXDom.h(\"span\", { style: `position: fixed; top: ${startY}px; left: ${startX}px; z-index: 1000; font-size: ${ghostSize}px; transition: all 1s ease-out; user-select: none;` }, \"\\uD83D\\uDC7B\"));\n    // Animate the ghost right after it's rendered.\n    setTimeout(() => {\n        easterEggEmoji.style.transform = `translateY(-${Math.round(ghostSize * 1.5)}px)`;\n        easterEggEmoji.style.opacity = '0';\n    }, 0);\n    // And clean up after the animation is complete.\n    setTimeout(() => {\n        easterEggEmoji.remove();\n    }, 1500);\n    // Add the ghost to the page!\n    document.body.append(easterEggEmoji);\n}\nfunction registerDblclickEasterEggIfNeeded(subtheme_name) {\n    if (subtheme_name === 'spooky') {\n        document.body.addEventListener('dblclick', createGhostEasterEggOnClick, {\n            passive: true,\n        });\n        document.body.addEventListener('touchend', createGhostEasterEggOnClick, {\n            passive: true,\n        });\n    }\n    else {\n        document.body.removeEventListener('dblclick', createGhostEasterEggOnClick);\n        document.body.removeEventListener('touchend', createGhostEasterEggOnClick);\n    }\n}\nfunction insertPumpkinsInThemePreview() {\n    document\n        .querySelectorAll('svg.primer-spec-theme-preview-spooky-light, svg.primer-spec-theme-preview-spooky-dark')\n        .forEach((svg) => {\n        if (!svg.querySelector('.spooky-pumpkins')) {\n            svg.appendChild(JSXDom.h(\"text\", { class: \"spooky-pumpkins\", x: \"180\", y: \"130\", \"dominant-baseline\": \"middle\", \"text-anchor\": \"middle\", style: \"font-size: 72px;\" }, \"\\uD83C\\uDF83\\uD83C\\uDF83\\uD83C\\uDF83\"));\n        }\n    });\n}\nfunction registerHalloweenSubthemeIfNeeded() {\n    if (!window.PrimerSpec?.REGISTERED_SUBTHEMES?.['spooky']) {\n        // NOTE: This block of code will only ever be called ONCE per page session.\n        window.PrimerSpec?.registerNewSubtheme?.('spooky', 'ðŸŽƒ Spooky ðŸ‘»', constructHalloweenSubtheme());\n        // Force-update the theme. The page will have already loaded with the\n        // default theme, so we need to re-render with the spooky theme.\n        window.PrimerSpec?.updateTheme?.({}, false);\n    }\n}\nfunction constructHalloweenSubtheme() {\n    // NOTE: This method will only ever be called ONCE per page session.\n    // Hence, we can perform actions that modify the page state without\n    // having to worry about duplicated effects.\n    // Start by deep-copying the default theme's definition.\n    const defaultSubthemeDef = window.PrimerSpec.REGISTERED_SUBTHEMES['default'].theme_definition;\n    const halloweenSubthemeDef = JSON.parse(JSON.stringify(defaultSubthemeDef));\n    // Since we want to use a custom font, we need to inject it into the page.\n    document.head.appendChild(JSXDom.h(\"link\", { href: \"https://fonts.googleapis.com/css2?family=Creepster&family=Architects+Daughter&display=swap\", rel: \"stylesheet\" }));\n    // 'Spooky' is a dark-only theme. We'll first define the dark-mode colors,\n    // then we'll completely remove the light-mode colors.\n    // Finally, replace the light colors with the dark ones.\n    halloweenSubthemeDef['light'] = halloweenSubthemeDef['dark'];\n    return halloweenSubthemeDef;\n}\nfunction toggleFontIfNeeded(subtheme_name) {\n    const existingStyleTag = document.getElementById('primer-spec-halloween-font');\n    if (subtheme_name === 'spooky' && !existingStyleTag) {\n        document.body.appendChild(JSXDom.h(\"style\", { id: \"primer-spec-halloween-font\" },\n            \"body, .markdown-body, p \",\n            '{',\n            \"font-family: 'Architects Daughter'; \",\n            '}',\n            \"h1, h2, h3, h4, h5, h6 \",\n            '{',\n            \"font-family: 'Creepster' !important; \",\n            '}'));\n    }\n    else if (subtheme_name !== 'spooky' && existingStyleTag) {\n        existingStyleTag.remove();\n    }\n}\nfunction getRandomInt(min, max) {\n    min = Math.ceil(min);\n    max = Math.floor(max);\n    return Math.floor(Math.random() * (max - min)) + min;\n}\n/*** SHY EMOJI ***/\nconst emojiSpanId = 'primer-spec-shy-emoji';\nconst keyframesCssId = 'primer-spec-shy-emoji-keyframes';\nfunction insertShyEmojiImpl(subtheme_name) {\n    const initHeight = getRandomInt(10, 90);\n    const spookyEmojis = ['ðŸŽƒ', 'ðŸ‘»', 'ðŸ¤«', 'ðŸ§™', 'ðŸ§›', 'ðŸ§Ÿ', 'ðŸ‘º'];\n    const chosenEmoji = spookyEmojis[getRandomInt(0, spookyEmojis.length)];\n    const peakFromMargin = getRandomInt(0, 2) === 0 ? 'right' : 'left';\n    const shyEmojiKeyframes = (JSXDom.h(\"style\", { id: keyframesCssId },\n        '@keyframes peak-in-out {',\n        '  from {',\n        `    ${peakFromMargin}: -70px;`,\n        '  }',\n        '  20% {',\n        `    ${peakFromMargin}: -20px;`,\n        '  }',\n        '  80% {',\n        `    ${peakFromMargin}: -20px;`,\n        '  }',\n        '  to {',\n        `    ${peakFromMargin}: -70px;`,\n        '  }',\n        '}',\n        '@keyframes fly {',\n        '  25% {',\n        `    top: ${getRandomInt(10, 90)}vh;`,\n        '  }',\n        '  60% {',\n        `    top: ${getRandomInt(-1, 101)}vh;`,\n        '  }',\n        '  to {',\n        `    top: ${getRandomInt(-10, 110)}vh;`,\n        `    ${peakFromMargin}: 110vw;`,\n        '  }',\n        '}'));\n    document.body.append(shyEmojiKeyframes);\n    const shyEmoji = (\n    // eslint-disable-next-line jsx-a11y/no-static-element-interactions, jsx-a11y/click-events-have-key-events\n    JSXDom.h(\"span\", { id: emojiSpanId, style: `position: fixed; top: ${initHeight}%; ${peakFromMargin}: -70px; font-size: 60px; z-index: 1000; user-select: none; cursor: pointer;`, onClick: () => {\n            // If the emoji is still in the middle of peaking in, we want the\n            // animation to begin from wherever it currently is.\n            shyEmoji.style[peakFromMargin] = window.getComputedStyle(shyEmoji)[peakFromMargin];\n            shyEmoji.style.animationDelay = '0s';\n            shyEmoji.style.animationDuration = '3s';\n            shyEmoji.style.animationName = 'fly';\n        } }, chosenEmoji));\n    // Peak In and Out\n    shyEmoji.style.animationFillMode = 'forwards';\n    shyEmoji.style.animationDelay = '2s';\n    shyEmoji.style.animationDuration = '25s';\n    shyEmoji.style.animationTimingFunction = 'ease-in-out';\n    shyEmoji.style.animationName = 'peak-in-out';\n    // CLEANUP\n    shyEmoji.onanimationend = () => {\n        shyEmoji.remove();\n        shyEmojiKeyframes.remove();\n        // Rinse and repeat!\n        insertShyEmojiIfNeeded(subtheme_name);\n    };\n    document.body.append(shyEmoji);\n}\nfunction insertShyEmojiIfNeeded(subtheme_name) {\n    document.getElementById(emojiSpanId)?.remove();\n    document.getElementById(keyframesCssId)?.remove();\n    if (subtheme_name === 'spooky') {\n        insertShyEmojiImpl(subtheme_name);\n    }\n}\n","import { initialize as initializeHalloweenPlugin } from './halloween.plugin';\nconst PLUGINS = [initializeHalloweenPlugin()]\n    .filter((pluginDefinition) => {\n    const forceEnableOption = pluginForceEnableOption(pluginDefinition.id);\n    if (forceEnableOption !== null) {\n        return forceEnableOption;\n    }\n    return pluginDefinition.shouldRun();\n})\n    .map((pluginDefinition) => pluginDefinition.plugin);\nexport async function executePlugins(input) {\n    await Promise.all(PLUGINS.map(async (plugin) => {\n        await plugin(input);\n    }));\n}\nfunction pluginForceEnableOption(pluginId) {\n    const match = window.location.search.match(new RegExp(`enable_${pluginId}=([0|1])`));\n    if (match) {\n        return match[1] === '1';\n    }\n    return null;\n}\n"],"names":["createGhostEasterEggOnClick","event","startX","startY","TouchEvent","touches","clientX","clientY","ghostSize","easterEggEmoji","style","setTimeout","transform","Math","round","opacity","remove","document","body","append","getRandomInt","min","max","ceil","floor","random","emojiSpanId","keyframesCssId","insertShyEmojiIfNeeded","subtheme_name","getElementById","initHeight","spookyEmojis","chosenEmoji","length","peakFromMargin","shyEmojiKeyframes","id","shyEmoji","onClick","window","getComputedStyle","animationDelay","animationDuration","animationName","animationFillMode","animationTimingFunction","onanimationend","insertShyEmojiImpl","PLUGINS","plugin","async","input","PrimerSpec","REGISTERED_SUBTHEMES","registerNewSubtheme","defaultSubthemeDef","theme_definition","halloweenSubthemeDef","JSON","parse","stringify","head","appendChild","href","rel","constructHalloweenSubtheme","updateTheme","settings_shown","querySelectorAll","forEach","svg","querySelector","class","x","y","settingsIconClassList","classList","add","replaceSettingsToggleWithHat","sidebarToggle","existingStyleTag","toggleFontIfNeeded","addEventListener","passive","removeEventListener","shouldRun","today","Date","getMonth","getDate","enabled_url","URL","location","searchParams","set","console","info","toString","filter","pluginDefinition","forceEnableOption","pluginId","match","search","RegExp","pluginForceEnableOption","map","executePlugins","Promise","all"],"sourceRoot":""}